import tkinter as tk
from tkinter import ttk, messagebox
from dataclasses import dataclass
@dataclass
class Persona:
    nombre: str
    apellidos: str
    documento: str
    anio_nacimiento: int
    genero: str
    pais: str
    activo: bool

    def edad(self, anio_actual=2025):
        try:
            return anio_actual - int(self.anio_nacimiento)
        except Exception:
            return None

class PersonaApp:
    def __init__(self, root):
        self.root = root
        root.title("Registro de Persona (Ej. 8.2)")
        root.geometry("520x360")
        self.personas = []

        frm = ttk.Frame(root, padding=12)
        frm.pack(fill=tk.BOTH, expand=True)

        ttk.Label(frm, text="Nombre:").grid(column=0, row=0, sticky=tk.W)
        self.nombre = ttk.Entry(frm, width=30); self.nombre.grid(column=1, row=0, pady=2)

        ttk.Label(frm, text="Apellidos:").grid(column=0, row=1, sticky=tk.W)
        self.apellidos = ttk.Entry(frm, width=30); self.apellidos.grid(column=1, row=1, pady=2)

        ttk.Label(frm, text="Documento:").grid(column=0, row=2, sticky=tk.W)
        self.documento = ttk.Entry(frm, width=30); self.documento.grid(column=1, row=2, pady=2)

        ttk.Label(frm, text="Año nacimiento:").grid(column=0, row=3, sticky=tk.W)
        self.anio = ttk.Entry(frm, width=10); self.anio.grid(column=1, row=3, sticky=tk.W, pady=2)

        ttk.Label(frm, text="Género:").grid(column=0, row=4, sticky=tk.W)
        self.genero_var = tk.StringVar(value="M")
        ttk.Radiobutton(frm, text="Masculino", variable=self.genero_var, value="M").grid(column=1, row=4, sticky=tk.W)
        ttk.Radiobutton(frm, text="Femenino", variable=self.genero_var, value="F").grid(column=1, row=4, sticky=tk.E)

        ttk.Label(frm, text="País:").grid(column=0, row=5, sticky=tk.W)
        self.pais_cb = ttk.Combobox(frm, values=["Colombia","Chile","Perú","España","Otro"], state="readonly", width=27)
        self.pais_cb.grid(column=1, row=5, pady=2)
        self.pais_cb.set("Colombia")

        self.activo_var = tk.BooleanVar(value=True)
        ttk.Checkbutton(frm, text="Activo", variable=self.activo_var).grid(column=1, row=6, sticky=tk.W, pady=6)

        btn_frame = ttk.Frame(frm)
        btn_frame.grid(column=0, row=7, columnspan=2, pady=6)
        ttk.Button(btn_frame, text="Agregar", command=self.agregar_persona).grid(column=0, row=0, padx=4)
        ttk.Button(btn_frame, text="Mostrar seleccionada", command=self.mostrar_seleccionada).grid(column=1, row=0, padx=4)
        ttk.Button(btn_frame, text="Limpiar campos", command=self.limpiar).grid(column=2, row=0, padx=4)

        ttk.Label(frm, text="Personas registradas:").grid(column=0, row=8, sticky=tk.W, pady=(8,0))
        self.lb = tk.Listbox(frm, height=6)
        self.lb.grid(column=0, row=9, columnspan=2, sticky="nsew", pady=(2,0))
        frm.rowconfigure(9, weight=1)
        frm.columnconfigure(1, weight=1)

    def agregar_persona(self):
        try:
            p = Persona(
                nombre=self.nombre.get().strip(),
                apellidos=self.apellidos.get().strip(),
                documento=self.documento.get().strip(),
                anio_nacimiento=int(self.anio.get().strip()),
                genero=self.genero_var.get(),
                pais=self.pais_cb.get(),
                activo=self.activo_var.get(),
            )
        except ValueError:
            messagebox.showerror("Error", "Año de nacimiento debe ser un entero.")
            return

        self.personas.append(p)
        self.lb.insert(tk.END, f"{p.nombre} {p.apellidos} - {p.documento}")
        messagebox.showinfo("OK", "Persona agregada correctamente.")
        self.limpiar()

    def mostrar_seleccionada(self):
        sel = self.lb.curselection()
        if not sel:
            messagebox.showwarning("Atención", "Seleccione una persona en la lista.")
            return
        idx = sel[0]
        p = self.personas[idx]
        edad = p.edad()
        activo_txt = "Sí" if p.activo else "No"
        info = (f"Nombre: {p.nombre} {p.apellidos}\n"
                f"Documento: {p.documento}\n"
                f"Año nacimiento: {p.anio_nacimiento} (edad aprox: {edad})\n"
                f"Género: {p.genero}\n"
                f"País: {p.pais}\n"
                f"Activo: {activo_txt}")
        messagebox.showinfo("Detalle Persona", info)

    def limpiar(self):
        self.nombre.delete(0, tk.END)
        self.apellidos.delete(0, tk.END)
        self.documento.delete(0, tk.END)
        self.anio.delete(0, tk.END)
        self.pais_cb.set("Colombia")
        self.genero_var.set("M")
        self.activo_var.set(True)

if __name__ == "__main__":
    root = tk.Tk()
    app = PersonaApp(root)
    root.mainloop()
